"use strict";angular.module("ui.sortable",[]).value("uiSortableConfig",{}).directive("uiSortable",["uiSortableConfig","$timeout","$log",function(e,t,n){return{require:"?ngModel",link:function(r,i,s,o){function a(e,t){if(t&&typeof t==="function"){return function(n,r){e(n,r);t(n,r)}}return e}var u;var f={};var l={receive:null,remove:null,start:null,stop:null,update:null};angular.extend(f,e);if(o){r.$watch(s.ngModel+".length",function(){t(function(){i.sortable("refresh")})});l.start=function(e,t){t.item.sortable={index:t.item.index(),cancel:function(){t.item.sortable._isCanceled=true},isCanceled:function(){return t.item.sortable._isCanceled},_isCanceled:false}};l.activate=function(){u=i.contents();var e=i.sortable("option","placeholder");if(e&&e.element&&typeof e.element==="function"){var t=e.element();if(!t.jquery){t=angular.element(t)}var n=i.find('[class="'+t.attr("class")+'"]');u=u.not(n)}};l.update=function(e,t){if(!t.item.sortable.received){t.item.sortable.dropindex=t.item.index();t.item.sortable.droptarget=t.item.parent();i.sortable("cancel")}u.detach();if(i.sortable("option","helper")==="clone"){u=u.not(u.last())}u.appendTo(i);if(t.item.sortable.received&&!t.item.sortable.isCanceled()){r.$apply(function(){o.$modelValue.splice(t.item.sortable.dropindex,0,t.item.sortable.moved)})}};l.stop=function(e,t){if(!t.item.sortable.received&&"dropindex"in t.item.sortable&&!t.item.sortable.isCanceled()){r.$apply(function(){o.$modelValue.splice(t.item.sortable.dropindex,0,o.$modelValue.splice(t.item.sortable.index,1)[0])})}else{if((!("dropindex"in t.item.sortable)||t.item.sortable.isCanceled())&&i.sortable("option","helper")!=="clone"){u.detach().appendTo(i)}}};l.receive=function(e,t){t.item.sortable.received=true};l.remove=function(e,t){if(!t.item.sortable.isCanceled()){r.$apply(function(){t.item.sortable.moved=o.$modelValue.splice(t.item.sortable.index,1)[0]})}};r.$watch(s.uiSortable,function(e){angular.forEach(e,function(e,t){if(l[t]){if(t==="stop"){e=a(e,function(){r.$apply()})}e=a(l[t],e)}i.sortable("option",t,e)})},true);angular.forEach(l,function(e,t){f[t]=a(e,f[t])})}else{n.info("ui.sortable: ngModel not provided!",i)}i.sortable(f)}}}])